# .htaccess
# Configuración Apache para picoyplacabogota.com.co
# Incluye: Redirecciones 301 (SEO Migration) y URLs amigables

<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /
# --- ESTRATEGIA SEO: MAÑANA (Evergreen) ---
    # URL: /pico-y-placa/bogota/manana/particulares
    # Internamente lo mandamos a index.php con una bandera &es_manana=1
    RewriteRule ^pico-y-placa/([a-z-]+)/manana/([a-z-]+)/?$ index.php?ciudad_slug=$1&es_manana=1&tipo=$2 [L,QSA]
    # ----------------------------------------------------------------------
    # 1. MIGRACIÓN SEO: Redireccionar URLs antiguas a la nueva estructura
    # ----------------------------------------------------------------------
    
    # CASO A: URL antigua SIN tipo de vehículo -> Redirigir a NUEVA con /particulares
    RewriteCond %{REQUEST_URI} ^/pico-y-placa/([a-z-]+)-([0-9]{1,2})-de-([a-z]+)-de-([0-9]{4})/?$
    RewriteRule ^(.*)$ https://picoyplacabogota.com.co/$1/particulares [R=301,L]

    # CASO B: URL antigua CON tipo (si existía) -> Asegurar dominio nuevo
    RewriteCond %{HTTPS} off
    RewriteRule ^(.*)$ https://picoyplacabogota.com.co/$1 [R=301,L]

    # ----------------------------------------------------------------------
    # 2. ENRUTAMIENTO DE LA APLICACIÓN (Lógica interna)
    # ----------------------------------------------------------------------

    # --- NUEVA REGLA: Estrategia SEO "Mañana" (Evergreen) ---
    # URL: /pico-y-placa/bogota/manana/particulares
    RewriteRule ^pico-y-placa/([a-z-]+)/manana/([a-z-]+)/?$ index.php?ciudad_slug=$1&es_manana=1&tipo=$2 [L,QSA]

    # Regla para URLs amigables completas: /pico-y-placa/ciudad-fecha/tipo
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^pico-y-placa/([a-z-]+)-([0-9]{1,2})-de-([a-z]+)-de-([0-9]{4})/([a-z-]+)/?$ index.php?ciudad_slug=$1&dia=$2&mes_nombre=$3&ano=$4&tipo=$5 [L,QSA]

    # Regla de respaldo (Fallback)
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ index.php [L,QSA] 

</IfModule>

# ----------------------------------------------------------------------
# 3. OPTIMIZACIONES Y SEGURIDAD
# ----------------------------------------------------------------------

<IfModule mod_headers.c>
    Header set Content-Type "text/html; charset=utf-8"
    # Cacheo de recursos estáticos (CSS/JS/IMG) por 1 semana para velocidad
    <FilesMatch "\.(css|js|png|jpg|jpeg|svg|ico)$">
        Header set Cache-Control "max-age=604800, public"
    </FilesMatch>
</IfModule>

AddDefaultCharset UTF-8
